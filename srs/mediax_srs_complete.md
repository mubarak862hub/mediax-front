# تكملة مستند متطلبات النظام (SRS) — MediaX

هذا المستند يكمل ويفصل متطلبات المشروع الأصلية ويقدم تصميمًا وظيفيًا لكل صفحة وميزات التطبيق لتوجيه التطوير الأمامي والخلفي.

## 1. نظرة عامة مُصغّرة
- النوع: تطبيق واجهة مستخدم ثابتة (Frontend) + backend مقترح (Laravel).
- اللغة الأساسية: العربية، اتجاه RTL.
- هدف هذا الملف: تحويل المتطلبات العامة الموجودة في `srs/mediax_srs_document.md` إلى مواصفات قابلة للتنفيذ للواجهات والميزات.

## 2. متطلبات وظيفية مُفصّلة (مُرتبة حسب الأولوية)
- التسجيل / الدخول: سجل / سجل دخول بالبريد وكلمة مرور، خيار "تذكرني" يخزن بريد المستخدم في `localStorage` على الواجهة، عمليات إعادة التوجيه بعد النجاح.
- استعراض المحتوى: صفحات قائمة حسب النوع مع فلتر متعدد القيم (نوع، سنة، جودة، فئة عمرية، تقييم).
- مشاهدة: تشغيل فيديو (مشغل بدائي على الواجهة) مع معاينة 30 ثانية للزوار، إمكانية اختيار الجودة والترجمة.
- القوائم والمفضلات: إضافة/إزالة من "قائمة المشاهدة" و"المفضلة"، حالة مرئية (`favorited` class).
- البحث: صندوق بحث مركزي يدعم استعلامات عربية، نتائج قابلة للتصفية.
- إدارة المحتوى (Admin): CRUD للمحتوى، مراجعة تقارير المستخدمين، إحصائيات.
- اشتراكات ومدفوعات: صفحات لتسجيل نوع الاشتراك وعرض حالة المستخدم.

## 3. تصميم كل صفحة وميزاتها (الواجهات الأمامية)

ملاحظة: عند الإشارة إلى ملفات الواجهة/البرمجيات، استعمل الملفات الموجودة في المشروع: `index.html`, `movies.html`, `details.html`, `login.html`, `register.html`, `profile.html`, `favorites.html`, `watchlist.html`, `subscription.html`, `settings.html`, `admin/*`.

### 3.1 الصفحة الرئيسية (`index.html`)
- الهدف: عرض محتوى مميز وجذب المستخدم.
- تخطيط:
  - Header ثابت: شعار، روابط رئيسية، زر البحث (`#searchBtn`)، أيقونة الملف الشخصي.
  - Hero: فيديو/بوستر كبير لمحتوى مميز مع زر تشغيل ومعلومات سريعة.
  - صفوف محتوى أفقية (sliders): "مميز"، "الأكثر مشاهدة"، "جديد"، كل صف عبارة عن `.content-row` ويستخدم `js/main.js` للسلوك.
  - Footer: روابط ثابتة، سياسات، تواصل.
- مكونات:
  - بطاقات محتوى `.content-card` تحتوي عنوان (`.card-title`)، صورة lazy `data-src`, أزرار أفعال (`.action-btn`).
  - أزرار التمرير للـ slider `.slider-btn-prev/next` تتصل بـ `window.MediaX.scrollSlider`.
- تفاعلات:
  - النقر على البطاقة يفتح `details.html?id=...` (TODO لتمرير id).
  - زر التشغيل يعرض إشعار ثم ينقل إلى صفحة المشاهدة أو يفتح مودال.

### 3.2 صفحات التصفح (`movies.html`, `series.html`, `games.html`, `books.html`)
- هدف: عرض شبكة/قائمة بالمحتوى من نوع معين.
- تخطيط:
  - شريط تصفية على اليسار/أعلى (حسب عرض الشاشة) بخيارات: النوع الفرعي، السنة، الجودة، السعر، الترتيب.
  - تبديل العرض Grid/List.
- مكونات:
  - بطاقات قابلة لإعادة الاستخدام، pagination أو lazy-load (infinite scroll).
- تفاعلات:
  - تطبيق الفلاتر يغير استعلام البحث المحلي أو يقوم بـ POST `/api/بحث`.

### 3.3 صفحة تفاصيل المحتوى (`details.html`)
- هدف: تقديم كل المعلومات عن عنصر محتوى واحد.
- تخطيط:
  - شريط أعلى: عنوان كبير وملصق وصندوق أفعال (تشغيل، إضافة للقائمة، مفضلة، مشاركة).
  - مشغل/معاينة في الأعلى (أو زر عرض المعاينة 30s للزوار).
  - وصف طويل، بيانات تقنية (السنة، الجهة الناشرة، اللغة، المدة/صفحات/حجم).
  - قسم التقييمات والمراجعات: عرض متوسط التقييم + قائمة مراجعات، زر إضافة مراجعة.
  - قسم محتوى مشابه/اقتراحات.
- تفاعلات:
  - إرسال تقييم أو مراجعة عبر POST `/api/تقييم` مع التحقق من تسجيل الدخول.

### 3.4 صفحة المشاهدة/المشغل
- هدف: تجربة مشاهدة بدون تشتيت.
- تخطيط:
  - مشغل الفيديو (Video.js مقترح لاحقًا)، شريط تحكم (play/pause، جودة، الترجمات، سرعة، fullscreen).
  - معلومات ما بعد المشاهدة: توصيات، التعليقات.
- تفاعلات:
  - حفظ نقطة التقدم عبر API أو localStorage للسجلات.
  - تقرير مشكلة يفتح مودال يرسل POST `/api/report`.

### 3.5 صفحة البحث ونتائج البحث
- هدف: عرض نتائج فرز وقابلة للتصفية.
- مكونات: شريط بحث مركزي، فلاتر، نتائج مع تمييز للعبارة المطابقة.

### 3.6 صفحة الدخول والتسجيل (`login.html`, `register.html`)
- هدف: عملية تسجيل ودخول مبسطة بالتصدي للـ validation بالعربية.
- مكونات:
  - حقول إدخال، أزرار toggle لإظهار/إخفاء كلمة المرور (موجودة في `js/auth.js`).
  - مؤشرات قوة كلمة المرور ومطابقة التأكيد.
- تفاعلات:
  - تذكر البريد عبر `localStorage` عند اختيار "تذكرني".
  - محاكاة API بـ `simulateApiCall()` في الواجهة حتى يتوفر backend.

### 3.7 صفحات المستخدم (`profile.html`, `watchlist.html`, `favorites.html`)
- هدف: إدارة الملف الشخصي وقوائم المستخدم.
- مكونات:
  - عرض الاشتراكات، تاريخ المعاملات، زر لتغيير كلمة المرور.
  - قوائم قابلة للتحرير (حذف، إعادة ترتيب)، عرض حالة التحميل/التحميلات.

### 3.8 لوحة الإدارة (مخطط - backend heavy)
- صفحات: Dashboard, Manage Content, Manage Users, Reports, Settings.
- متطلبات رئيسية: مصادقة مشرف، CRUD للمحتوى، استيراد/تصدير CSV، مراجعة بلاغات.

## 4. الميزات العامة والسلوكيات المشتركة
- RTL: جميع صفحات تستخدم RTL، direction: rtl في الـ CSS الأساسي.
- Lazy Loading: جميع الصور تستخدم `data-src` ويتم تحميلها عبر `initializeLazyLoading()`.
- Notifications: استخدم `window.MediaX.showNotification(message, type)` لعرض التنبيهات.
- حالة التمرير: `header` يضيف/يزيل `scrolled` class عند النزول.
- Sliders: استخدم `.content-slider` مع أزرار prev/next ونفذ دعوات `scrollSlider`.

## 5. واجهات API مقترحة (map to frontend)
- GET /api/المحتوى?page=&type=&filters... — قائمة المحتوى (للصفحات الرئيسية وصفحات التصفح)
- GET /api/المحتوى/{id} — تفاصيل محتوى
- POST /api/بحث {q, filters} — بحث نصي بالعربية
- POST /api/تسجيل — تسجيل مستخدم
- POST /api/تسجيل-دخول — جلسة / token
- GET /api/ملف-شخصي — بيانات المستخدم
- POST /api/مفضلة — toggle favorite
- POST /api/قائمة — إضافة/إزالة من قائمة المشاهدة
- POST /api/تقييم — ارسال تقييم/مراجعة

ملاحظات: استخدم JSON responses مع حقول خطأ/نجاح واضحة ومحليّة الرسائل بالعربية.

## 6. نموذج بيانات (مركّز على الحقول اللازمة للـ Frontend)
- Content: id, slug, title_ar, title_en, description_ar, images[], poster, year, language, age_rating, duration, pages, size, type, categories[], tags[], quality, price, assets {video_urls, subs}, rating_avg, rating_count
- User: id, name, email, avatar, roles[], subscriptions[], favorites[], watchlist[], watch_history[{content_id, position, updated_at}]

## 7. المتطلبات غير الوظيفية (مفصّلة للواجهة)
- الأداء: صفحات رئيسية يجب أن تُظهر ما يظهر فوق الطي (above-the-fold) في أقل من 1.5s على شبكة 3G متوسطة.
- الصور: استخدم WebP عند الإمكان و`srcset` لصور متعددة الأحجام.
- الأمن: لا تخزن حساسية (مثل tokens) في plain localStorage بدون حماية من XSS، تحقق من صلاحيات العرض قبل عرض أزرار الإدارة.

## 8. إرشادات التطوير والعمليات (خاص بالـ repo الحالي)
- تشغيل محلي سريع: استخدم:
```bash
npm install
npm run dev
```
  أو افتح `index.html` مباشرة إذا لم تُرِد خادمًا.
- اتبع نمط DOM-first: سجّل المستمعين داخل `DOMContentLoaded` كما في `js/auth.js`.
- أضف وظائف مشتركة إلى `window.MediaX` عند الحاجة لمشاركة واجهات (pattern موجود في `js/main.js`).

## 9. اختبار القبول السريع (checklist)
- تسجيل/دخول يعمل (mock) ويعيد توجيه إلى `index.html`.
- البحث يعرض نتائج وهمية عند الاستعلام.
- إضافة/إزالة من المفضلة وتعليق بصري (class `favorited`) يعمل في البطاقة.
- Lazy images تتحول من `data-src` إلى `src` عند الظهور.

## 10. تسليمات مقترحة (ملفات/مكونات لإضافتها الآن)
- `js/api.js` — adapter بسيط للتعامل مع API (GET/POST، ترجمة الأخطاء).
- `components/Player.js` — غلاف للمشغل (مستقبلاً يمكن تبديله إلى Video.js).
- صفحات HTML محدثة مع data-ids لتسهيل الربط بالـ backend.

## 11. الخطوات التالية (مطلوبة منك)
1. راجع هذا المستند وحدد أي تغييرات أو أولويات (مثال: هل المنصة ستدعم تنزيل الألعاب أم روابط تحميل خارجية فقط؟).
2. أخبرني إن كنت أضيف سكافولد `js/api.js` وملف `srs/api-endpoints.md` مفصّل.

---
ملف مُنشأ تلقائياً لتكملة SRS الأم — أخبرني أي موضع تريد تفصيلاً أكبر فيه (مثال: مسار بيانات المشاهدة، مخطط قواعد بيانات ER، أو واجهات API مفصّلة مع أمثلة JSON).
